<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
	<style>
		figure{
			float : left;
		}
		h1 {
				text-align:center;
				text-shadow:1px;
			}
		img {
				margin:20px;
				width: 180px;
  			  	box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
  				text-align: center;
		    }
		input{				
				margin:50px;
			}
		section{
			text-align:center;
		}
	</style>
</head>

<body>
	<h1 id="h1">2020  개봉영화</h1>
	<hr>
	<figure>
		<div>
				<img src="/sedu/images/movie2020/01.jpg" id="p001">
				<img src="/sedu/images/movie2020/02.jpg" id="p002">
				<img src="/sedu/images/movie2020/03.jpg" id="p003">
				<img src="/sedu/images/movie2020/04.jpg" id="p004">
				<img src="/sedu/images/movie2020/05.jpg" id="p005">
		
		<div>
				<img src="/sedu/images/movie2020/06.jpg" id="p006">
				<img src="/sedu/images/movie2020/07.jpg" id="p007">
				<img src="/sedu/images/movie2020/08.jpg" id="p008">
				<img src="/sedu/images/movie2020/09.jpg" id="p009">
				<img src="/sedu/images/movie2020/10.jpg" id="p010">
		</div>
	</figure>
	<section>
		<input type="image" src="/sedu/images/delete.png" alt="Submit" width="50px">
	</section>
	<div id = "movielist"></div>
	<script>
		window.onload = function() {
			var images = document.querySelectorAll('img');
			console.log(images.length);
			for (var i = 0; i < images.length; i++) {
				images[i].addEventListener("click", getData);
			}

			var btn = document.querySelector('input');
			btn.addEventListener("click", destroySession);
		};
			
		function getData(e){
			console.log("getdata호출")
			var request = new XMLHttpRequest();
			request.onload = function(event) {
				
				if (request.status == 200) {
					var str = request.responseText;
					console.log(str);
					var obj = JSON.parse(str);
					
					var target = document.getElementById('movielist');
					target.innerHTML = "";
					for(var pname in obj){
						if(pname == "null") continue;
						target.innerHTML += "<ul>"+ pname +" : " + obj[pname]+"</ul>";
					}
				}
			};
			console.log(this.id);
			request.open('GET', "http://localhost:8000/sedu/basket2?action=click&pid="+this.id, true);
			request.send();
		}

		function destroySession(e){
			console.log("destroySession");
			var request = new XMLHttpRequest();
			request.onload = function(event){
				if(request.status == 200){
					var str = request.responseText;
					var obj = JSON.parse(str);
					var target = document.getElementById('movielist');
					target.innerHTML = obj.msg;
				}
			}
			request.open('GET', "http://localhost:8000/sedu/basket2?action=destroy", true);
			request.send();
		}
	</script>
</body>

</html>